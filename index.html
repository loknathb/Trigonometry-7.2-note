<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>সংযুক্ত কোণের ত্রিকোণমিতি - লোকনাথ ম্যাথ টিচিং হোম</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- MathJax Configuration -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']]
        },
        svg: {
          fontCache: 'global'
        }
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        body {
            font-family: 'Hind Siliguri', sans-serif;
            background-color: #f0f4f8;
        }
        .page-container {
            max-width: 800px;
            margin: 2rem auto;
            background-color: white;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .page {
            border-bottom: 2px dashed #cbd5e0;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
        .page:last-child {
            border-bottom: none;
        }
        .page-header, .page-footer {
            background-color: #f7fafc;
            color: #4a5568;
            text-align: center;
            padding: 0.75rem;
            border-bottom: 1px solid #e2e8f0;
            border-top: 1px solid #e2e8f0;
        }
        .page-header {
            font-size: 1.1rem;
            font-weight: 600;
        }
        .page-footer {
            font-size: 0.875rem;
            margin-top: 1.5rem;
        }
        .content {
            padding: 1.5rem 2rem;
            line-height: 1.8;
        }
        .example-box {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 1rem;
            margin-top: 1rem;
        }
        .quiz-question {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: #edf2f7;
            border-left: 4px solid #4299e1;
            border-radius: 5px;
        }
        .quiz-options label {
            display: block;
            padding: 0.5rem;
            margin-top: 0.5rem;
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .quiz-options input[type="radio"] {
            margin-right: 10px;
        }
        .quiz-options label:hover {
            background-color: #ebf8ff;
            border-color: #90cdf4;
        }
        .submit-btn {
            display: block;
            width: calc(100% - 4rem);
            margin: 2rem;
            padding: 1rem;
            background-color: #48bb78;
            color: white;
            font-size: 1.125rem;
            font-weight: 700;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .submit-btn:hover {
            background-color: #38a169;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transition: opacity 0.3s;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }
        .hidden {
            display: none;
        }
        .result-item {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 5px;
            text-align: left;
        }
        .result-item.correct {
            background-color: #c6f6d5;
            border-left: 5px solid #38a169;
        }
        .result-item.incorrect {
            background-color: #fed7d7;
            border-left: 5px solid #e53e3e;
        }
    </style>
</head>
<body>

<div class="page-container">
    <div class="content">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-4">অধ্যায় ৭: সংযুক্ত কোণের ত্রিকোণমিতি (7.2)</h1>
        <p class="text-center text-gray-600 mb-6">আপনার নাম ও মোবাইল নম্বর লিখে প্রতিটি টপিকের কুইজে অংশ নিন। সবশেষে উত্তর জমা দিন।</p>
    </div>

    <form id="quizForm">
        <div class="px-8 mb-6">
            <div class="mb-4">
                <label for="userName" class="block text-gray-700 text-sm font-bold mb-2">শিক্ষার্থীর নাম:</label>
                <input type="text" id="userName" name="userName" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="আপনার সম্পূর্ণ নাম লিখুন" required>
            </div>
            <div>
                <label for="mobileNumber" class="block text-gray-700 text-sm font-bold mb-2">মোবাইল নম্বর:</label>
                <input type="tel" id="mobileNumber" name="mobileNumber" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="আপনার মোবাইল নম্বর লিখুন" required>
            </div>
        </div>

        <!-- Page 1: Topic 1 -->
        <div class="page">
            <div class="page-header">লোকনাথ ম্যাথ টিচিং হোম</div>
            <div class="content">
                <h2 class="text-2xl font-semibold mb-3">টপিক ১: যৌগিক কোণের সূত্রাবলী</h2>
                <ul class="list-disc list-inside space-y-2">
                    <li>$sin(A \pm B) = sin A \cdot cos B \pm cos A \cdot sin B$</li>
                    <li>$cos(A \pm B) = cos A \cdot cos B \mp sin A \cdot sin B$</li>
                    <li>$tan(A \pm B) = \frac{tan A \pm tan B}{1 \mp tan A \cdot tan B}$</li>
                </ul>
                <div class="quiz-question" data-question-id="q1_1" data-correct="c">
                    <p class="font-semibold">কুইজ ১.১: $cos(A - B)$ এর সঠিক সূত্র কোনটি?</p>
                    <div class="quiz-options">
                        <label><input type="radio" name="q1_1" value="a" required> ক) $cos A cos B - sin A sin B$</label>
                        <label><input type="radio" name="q1_1" value="b"> খ) $sin A cos B + cos A sin B$</label>
                        <label><input type="radio" name="q1_1" value="c"> গ) $cos A cos B + sin A sin B$</label>
                        <label><input type="radio" name="q1_1" value="d"> ঘ) $sin A sin B - cos A cos B$</label>
                    </div>
                    <div class="explanation hidden"><b>ব্যাখ্যা:</b> যৌগিক কোণের সূত্র অনুযায়ী, $cos(A - B) = cos A cos B + sin A sin B$ হয়।</div>
                </div>
            </div>
            <div class="page-footer">লোকনাথ বণিক, প্রভাষক (উচ্চতর গণিত), মোবাইল নম্বর: ০১৭৪৮৯২৯৯৫৭</div>
        </div>

        <!-- Page 2: Topic 2 -->
        <div class="page">
            <div class="page-header">লোকনাথ ম্যাথ টিচিং হোম</div>
            <div class="content">
                <h2 class="text-2xl font-semibold mb-3">টপিক ২: নির্দিষ্ট কোণের মান নির্ণয়</h2>
                <div class="example-box">
                    <b>উদাহরণ: $sin 105^{\circ}$ এর মান নির্ণয়:</b>
                    <p>$sin 105^{\circ} = sin(60^{\circ} + 45^{\circ})$ <br>
                    $= sin 60^{\circ} cos 45^{\circ} + cos 60^{\circ} sin 45^{\circ}$ <br>
                    $= \frac{\sqrt{3}}{2} \times \frac{1}{\sqrt{2}} + \frac{1}{2} \times \frac{1}{\sqrt{2}} = \frac{\sqrt{3}+1}{2\sqrt{2}} = \frac{\sqrt{6}+\sqrt{2}}{4}$</p>
                </div>
                <div class="quiz-question" data-question-id="q2_1" data-correct="c">
                    <p class="font-semibold">কুইজ ২.১: $cot 15^{\circ}$ এর মান কোনটি?</p>
                    <div class="quiz-options">
                        <label><input type="radio" name="q2_1" value="a" required> ক) $2 - \sqrt{3}$</label>
                        <label><input type="radio" name="q2_1" value="b"> খ) $\frac{\sqrt{3}+1}{\sqrt{3}-1}$</label>
                        <label><input type="radio" name="q2_1" value="c"> গ) $2 + \sqrt{3}$</label>
                        <label><input type="radio" name="q2_1" value="d"> ঘ) $1$</label>
                    </div>
                    <div class="explanation hidden"><b>ব্যাখ্যা:</b> $tan 15^{\circ} = 2 - \sqrt{3}$। আমরা জানি, $cot 15^{\circ} = \frac{1}{tan 15^{\circ}} = \frac{1}{2 - \sqrt{3}} = 2 + \sqrt{3}$।</div>
                </div>
            </div>
            <div class="page-footer">লোকনাথ বণিক, প্রভাষক (উচ্চতর গণিত), মোবাইল নম্বর: ০১৭৪৮৯২৯৯৫৭</div>
        </div>

        <!-- Page 3: Topic 3 -->
        <div class="page">
            <div class="page-header">লোকনাথ ম্যাথ টিচিং হোম</div>
            <div class="content">
                <h2 class="text-2xl font-semibold mb-3">টপিক ৩: যৌগিক কোণের মান নির্ণয়</h2>
                <div class="example-box">
                    <b>উদাহরণ:</b> যদি $sin A = \frac{3}{5}$ এবং $cos B = \frac{12}{13}$ হয় (A, B সূক্ষ্মকোণ), $cos(A+B)$ এর মান নির্ণয় কর।<br>
                    <b>সমাধান:</b><br>
                    $sin A = \frac{3}{5} \implies cos A = \sqrt{1 - sin^2 A} = \sqrt{1 - (\frac{3}{5})^2} = \frac{4}{5}$<br>
                    $cos B = \frac{12}{13} \implies sin B = \sqrt{1 - cos^2 B} = \sqrt{1 - (\frac{12}{13})^2} = \frac{5}{13}$<br>
                    $cos(A+B) = cos A cos B - sin A sin B = \frac{4}{5} \times \frac{12}{13} - \frac{3}{5} \times \frac{5}{13} = \frac{48-15}{65} = \frac{33}{65}$
                </div>
                <div class="quiz-question" data-question-id="q3_1" data-correct="b">
                    <p class="font-semibold">কুইজ ৩.১: যদি $cot A = \frac{11}{2}$ এবং $tan B = \frac{7}{24}$ হয়, তবে $tan(A+B)$ এর মান কত?</p>
                    <div class="quiz-options">
                        <label><input type="radio" name="q3_1" value="a" required> ক) $\frac{125}{278}$</label>
                        <label><input type="radio" name="q3_1" value="b"> খ) $\frac{1}{2}$</label>
                        <label><input type="radio" name="q3_1" value="c"> গ) $\frac{2}{3}$</label>
                        <label><input type="radio" name="q3_1" value="d"> ঘ) $\frac{118}{250}$</label>
                    </div>
                    <div class="explanation hidden"><b>ব্যাখ্যা:</b> $tan A = \frac{1}{cot A} = \frac{2}{11}$। $tan(A+B) = \frac{tan A + tan B}{1 - tan A tan B} = \frac{\frac{2}{11} + \frac{7}{24}}{1 - \frac{2}{11} \cdot \frac{7}{24}} = \frac{\frac{48+77}{264}}{\frac{264-14}{264}} = \frac{125}{250} = \frac{1}{2}$।</div>
                </div>
            </div>
            <div class="page-footer">লোকনাথ বণিক, প্রভাষক (উচ্চতর গণিত), মোবাইল নম্বর: ০১৭৪৮৯২৯৯৫৭</div>
        </div>

        <!-- Page 4: Topic 4 -->
        <div class="page">
            <div class="page-header">লোকনাথ ম্যাথ টিচিং হোম</div>
            <div class="content">
                <h2 class="text-2xl font-semibold mb-3">টপিক ৪: রাশিকে সরলীকরণ</h2>
                 <div class="example-box">
                    <b>উদাহরণ:</b> $\frac{cos 8^{\circ} + sin 8^{\circ}}{cos 8^{\circ} - sin 8^{\circ}}$ এর মান নির্ণয় কর।<br>
                    <b>সমাধান:</b> লব ও হরকে $cos 8^{\circ}$ দ্বারা ভাগ করে পাই,<br>
                    $\frac{1 + tan 8^{\circ}}{1 - tan 8^{\circ}} = \frac{tan 45^{\circ} + tan 8^{\circ}}{1 - tan 45^{\circ} \cdot tan 8^{\circ}} = tan(45^{\circ} + 8^{\circ}) = tan 53^{\circ}$
                </div>
                <div class="quiz-question" data-question-id="q4_1" data-correct="a">
                    <p class="font-semibold">কুইজ ৪.১: $cos 30^{\circ}32' cos 29^{\circ}28' - sin 149^{\circ}28' sin 29^{\circ}28'$ এর মান কত?</p>
                    <div class="quiz-options">
                        <label><input type="radio" name="q4_1" value="a" required> ক) $\frac{1}{2}$</label>
                        <label><input type="radio" name="q4_1" value="b"> খ) $\frac{\sqrt{3}}{2}$</label>
                        <label><input type="radio" name="q4_1" value="c"> গ) $0$</label>
                        <label><input type="radio" name="q4_1" value="d"> ঘ) $1$</label>
                    </div>
                    <div class="explanation hidden"><b>ব্যাখ্যা:</b> রাশিটি হলো $cos(30^{\circ}32' + 29^{\circ}28') = cos 60^{\circ} = \frac{1}{2}$। কারণ $sin 149^{\circ}28' = sin(180^{\circ} - 30^{\circ}32') = sin 30^{\circ}32'$। কিন্তু সূত্রে বিয়োগ চিহ্ন থাকায় এটি $cos(A+B)$ এর সূত্র নয়, বরং $cos A cos B - sin A sin B$ এর মতো। এখানে একটি ভুল আছে, মূল নোটে $sin(180-A)=sinA$ ব্যবহার করে $cos(A+B)$ এর সূত্রে আনা হয়েছে। $sin 149^{\circ}28' = sin(180^{\circ}-30^{\circ}32') = sin 30^{\circ}32'$। তাই রাশিটি দাঁড়ায় $cos 30^{\circ}32' cos 29^{\circ}28' - sin 30^{\circ}32' sin 29^{\circ}28' = cos(30^{\circ}32' + 29^{\circ}28') = cos 60^{\circ} = \frac{1}{2}$।</div>
                </div>
            </div>
            <div class="page-footer">লোকনাথ বণিক, প্রভাষক (উচ্চতর গণিত), মোবাইল নম্বর: ০১৭৪৮৯২৯৯৫৭</div>
        </div>

        <!-- Page 5: Topic 5 -->
        <div class="page">
            <div class="page-header">লোকনাথ ম্যাথ টিচিং হোম</div>
            <div class="content">
                <h2 class="text-2xl font-semibold mb-3">টপিক ৫: $tan$ সম্পর্কিত অভেদ প্রমাণ</h2>
                <div class="example-box">
                    <b>উদাহরণ:</b> প্রমাণ কর যে, $tan 65^{\circ} = tan 25^{\circ} + 2 tan 40^{\circ}$ <br>
                    <b>সমাধান:</b><br>
                    $tan 65^{\circ} = tan(25^{\circ} + 40^{\circ}) = \frac{tan 25^{\circ} + tan 40^{\circ}}{1 - tan 25^{\circ} tan 40^{\circ}}$<br>
                    বা, $tan 65^{\circ}(1 - tan 25^{\circ} tan 40^{\circ}) = tan 25^{\circ} + tan 40^{\circ}$<br>
                    বা, $tan 65^{\circ} - tan 65^{\circ} tan 25^{\circ} tan 40^{\circ} = tan 25^{\circ} + tan 40^{\circ}$<br>
                    বা, $tan 65^{\circ} - cot 25^{\circ} tan 25^{\circ} tan 40^{\circ} = tan 25^{\circ} + tan 40^{\circ}$<br>
                    বা, $tan 65^{\circ} - tan 40^{\circ} = tan 25^{\circ} + tan 40^{\circ}$<br>
                    $\therefore tan 65^{\circ} = tan 25^{\circ} + 2 tan 40^{\circ}$ (প্রমাণিত)
                </div>
                <div class="quiz-question" data-question-id="q5_1" data-correct="b">
                    <p class="font-semibold">কুইজ ৫.১: যদি $A+B = 45^{\circ}$ হয়, তবে $(1+tan A)(1+tan B)$ এর মান কত?</p>
                    <div class="quiz-options">
                        <label><input type="radio" name="q5_1" value="a" required> ক) $1$</label>
                        <label><input type="radio" name="q5_1" value="b"> খ) $2$</label>
                        <label><input type="radio" name="q5_1" value="c"> গ) $0$</label>
                        <label><input type="radio" name="q5_1" value="d"> ঘ) $-1$</label>
                    </div>
                    <div class="explanation hidden"><b>ব্যাখ্যা:</b> $A+B=45^{\circ} \implies tan(A+B) = tan 45^{\circ} = 1$। $\frac{tan A + tan B}{1 - tan A tan B} = 1 \implies tan A + tan B = 1 - tan A tan B$। $\implies tan A + tan B + tan A tan B = 1$। এখন, $(1+tan A)(1+tan B) = 1 + tan A + tan B + tan A tan B = 1 + (tan A + tan B + tan A tan B) = 1+1=2$।</div>
                </div>
            </div>
            <div class="page-footer">লোকনাথ বণিক, প্রভাষক (উচ্চতর গণিত), মোবাইল নম্বর: ০১৭৪৮৯২৯৯৫৭</div>
        </div>
        
        <!-- Page 6: Topic 6 -->
        <div class="page">
            <div class="page-header">লোকনাথ ম্যাথ টিচিং হোম</div>
            <div class="content">
                <h2 class="text-2xl font-semibold mb-3">টপিক ৬: ত্রিভুজের কোণ সম্পর্কিত সমস্যা ($A+B+C = \pi$)</h2>
                <div class="example-box">
                    <b>উদাহরণ:</b> যদি $A+B+C=\pi$ এবং $cos A = cos B cos C$ হয়, তবে প্রমাণ কর যে, $tan A = tan B + tan C$<br>
                    <b>সমাধান:</b><br>
                    $tan B + tan C = \frac{sin B}{cos B} + \frac{sin C}{cos C} = \frac{sin B cos C + cos B sin C}{cos B cos C}$<br>
                    $= \frac{sin(B+C)}{cos B cos C} = \frac{sin(\pi - A)}{cos A} = \frac{sin A}{cos A} = tan A$ (প্রমাণিত)
                </div>
                <div class="quiz-question" data-question-id="q6_1" data-correct="c">
                    <p class="font-semibold">কুইজ ৬.১: $\triangle ABC$-এ $tan A + tan B + tan C$ এর মান কোনটি?</p>
                    <div class="quiz-options">
                        <label><input type="radio" name="q6_1" value="a" required> ক) $1$</label>
                        <label><input type="radio" name="q6_1" value="b"> খ) $0$</label>
                        <label><input type="radio" name="q6_1" value="c"> গ) $tan A tan B tan C$</label>
                        <label><input type="radio" name="q6_1" value="d"> ঘ) $cot A cot B cot C$</label>
                    </div>
                    <div class="explanation hidden"><b>ব্যাখ্যা:</b> যেহেতু $A+B+C=\pi$, তাই $A+B = \pi - C$। $tan(A+B) = tan(\pi-C) = -tan C$। $\frac{tan A + tan B}{1 - tan A tan B} = -tan C \implies tan A + tan B = -tan C(1-tan A tan B) \implies tan A + tan B = -tan C + tan A tan B tan C$। অতএব, $tan A + tan B + tan C = tan A tan B tan C$।</div>
                </div>
            </div>
            <div class="page-footer">লোকনাথ বণিক, প্রভাষক (উচ্চতর গণিত), মোবাইল নম্বর: ০১৭৪৮৯২৯৯৫৭</div>
        </div>

        <!-- Page 7: Topic 7 -->
        <div class="page">
            <div class="page-header">লোকনাথ ম্যাথ টিচিং হোম</div>
            <div class="content">
                <h2 class="text-2xl font-semibold mb-3">টপিক ৭: শর্তমূলক অভেদ</h2>
                <div class="example-box">
                    <b>উদাহরণ:</b> যদি $tan \theta = k \cdot tan \phi$ এবং $\theta + \phi = \alpha$ হয়, তবে প্রমাণ কর যে, $sin(\theta - \phi) = \frac{k-1}{k+1} sin \alpha$.<br>
                    <b>সমাধান:</b><br>
                    $k = \frac{tan \theta}{tan \phi} = \frac{sin \theta cos \phi}{cos \theta sin \phi}$। যোজন-বিয়োজন করে, <br>
                    $\frac{k-1}{k+1} = \frac{sin \theta cos \phi - cos \theta sin \phi}{sin \theta cos \phi + cos \theta sin \phi} = \frac{sin(\theta - \phi)}{sin(\theta + \phi)} = \frac{sin(\theta - \phi)}{sin \alpha}$<br>
                    $\therefore sin(\theta - \phi) = \frac{k-1}{k+1} sin \alpha$ (প্রমাণিত)
                </div>
                <div class="quiz-question" data-question-id="q7_1" data-correct="a">
                    <p class="font-semibold">কুইজ ৭.১: যদি $cos\alpha cos\beta - sin\alpha sin\beta = 1$ হয়, তবে $1 + cot \alpha tan \beta$ এর মান কত?</p>
                    <div class="quiz-options">
                        <label><input type="radio" name="q7_1" value="a" required> ক) $0$</label>
                        <label><input type="radio" name="q7_1" value="b"> খ) $1$</label>
                        <label><input type="radio" name="q7_1" value="c"> গ) $2$</label>
                        <label><input type="radio" name="q7_1" value="d"> ঘ) $-1$</label>
                    </div>
                    <div class="explanation hidden"><b>ব্যাখ্যা:</b> $cos\alpha cos\beta - sin\alpha sin\beta = 1 \implies cos(\alpha+\beta) = 1 = cos 0^{\circ}$। অতএব, $\alpha + \beta = 0 \implies \alpha = -\beta$। এখন, $1 + cot \alpha tan \beta = 1 + cot(-\beta)tan\beta = 1 - cot\beta tan\beta = 1-1=0$।</div>
                </div>
            </div>
            <div class="page-footer">লোকনাথ বণিক, প্রভাষক (উচ্চতর গণিত), মোবাইল নম্বর: ০১৭৪৮৯২৯৯৫৭</div>
        </div>


        <button type="submit" id="submitButton" class="submit-btn">ফলাফল দেখুন ও জমা দিন</button>
    </form>
</div>

<!-- Modal for showing results -->
<div id="resultModal" class="modal hidden">
    <div class="modal-content">
        <h3 class="text-2xl font-bold mb-2">আপনার ফলাফল</h3>
        <p id="finalScore" class="text-lg font-bold mb-4"></p>
        <div id="resultDetails" class="space-y-4"></div>
        <p id="submissionStatus" class="text-sm mt-4"></p>
        <button id="closeModal" class="mt-6 px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">বন্ধ করুন</button>
    </div>
</div>

<script>
    // --- Google Apps Script URL ---
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw2NrYBoM-yjrrEgfJ5H1Z7SVlO9rRoVUg7sK4Y7iW6wwRbp5VtNEsV4ZU0tbdeWRXG/exec'; // আপনার গুগল অ্যাপস স্ক্রিপ্ট এর URL টি এখানে পেস্ট করুন

    const form = document.getElementById('quizForm');
    const submitButton = document.getElementById('submitButton');
    const modal = document.getElementById('resultModal');
    const finalScoreEl = document.getElementById('finalScore');
    const resultDetailsEl = document.getElementById('resultDetails');
    const submissionStatus = document.getElementById('submissionStatus');
    const closeModal = document.getElementById('closeModal');

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        let score = 0;
        const questions = document.querySelectorAll('.quiz-question');
        const totalQuestions = questions.length;
        let resultHTML = '';

        questions.forEach((question, index) => {
            const questionId = question.getAttribute('data-question-id');
            const questionText = question.querySelector('p').innerText;
            const correctAnswer = question.getAttribute('data-correct');
            const explanation = question.querySelector('.explanation').innerHTML;
            const selectedAnswerInput = question.querySelector(`input[name="${questionId}"]:checked`);
            
            let resultItem = '';
            if (selectedAnswerInput) {
                const userAnswer = selectedAnswerInput.value;
                const userAnswerText = selectedAnswerInput.parentElement.innerText;

                if (userAnswer === correctAnswer) {
                    score++;
                    resultItem = `
                        <div class="result-item correct">
                            <p class="font-bold">${index + 1}. ${questionText}</p>
                            <p>আপনার উত্তর: ${userAnswerText} (সঠিক)</p>
                        </div>`;
                } else {
                    resultItem = `
                        <div class="result-item incorrect">
                            <p class="font-bold">${index + 1}. ${questionText}</p>
                            <p>আপনার উত্তর: ${userAnswerText} (ভুল)</p>
                            <div class="mt-2 p-2 bg-gray-100 rounded">${explanation}</div>
                        </div>`;
                }
            } else {
                 resultItem = `
                    <div class="result-item incorrect">
                        <p class="font-bold">${index + 1}. ${questionText}</p>
                        <p>আপনি এই প্রশ্নের উত্তর দেননি।</p>
                        <div class="mt-2 p-2 bg-gray-100 rounded">${explanation}</div>
                    </div>`;
            }
            resultHTML += resultItem;
        });

        finalScoreEl.innerHTML = `আপনি মোট <b>${totalQuestions}</b> টির মধ্যে <b>${score}</b> নম্বর পেয়েছেন।`;
        resultDetailsEl.innerHTML = resultHTML;
        MathJax.typesetPromise([resultDetailsEl]);
        showModal();
        
        // --- Send Data to Google Sheet ---
        if (SCRIPT_URL.trim() === '') {
            submissionStatus.textContent = 'গুগল শীটে উত্তর জমা দেওয়া হয়নি (URL সেট করা নেই)।';
            return;
        }

        submitButton.disabled = true;
        submissionStatus.textContent = 'আপনার উত্তর গুগল শীটে জমা হচ্ছে...';

        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());
        data.timestamp = new Date().toLocaleString('bn-BD', { timeZone: 'Asia/Dhaka' });
        data.score = score;
        data.totalQuestions = totalQuestions;

        fetch(SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            cache: 'no-cache',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
            redirect: 'follow'
        })
        .then(res => {
            submissionStatus.textContent = 'আপনার উত্তর সফলভাবে জমা হয়েছে।';
        })
        .catch(err => {
            submissionStatus.textContent = 'একটি সমস্যা হয়েছে। অনুগ্রহ করে আবার চেষ্টা করুন।';
            console.error(err);
        })
        .finally(() => {
            submitButton.disabled = false;
        });
    });

    function showModal() {
        modal.classList.remove('hidden');
    }

    closeModal.addEventListener('click', function() {
        modal.classList.add('hidden');
        form.reset();
    });
</script>

</body>
</html>
